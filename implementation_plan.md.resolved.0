# NotebookLM用 Officeファイル一括変換ツール 実装計画

## 概要
ユーザーの指定したフォルダ内にあるOfficeファイル（Word, Excel, PowerPoint）を、NotebookLMが最も解釈しやすい**Markdown形式**に一括変換するPythonツールを作成します。また、ファイル数制限（50ファイル）を回避するため、変換結果を少数のファイルに結合する機能も提供します。

## ユーザーレビューが必要な事項
- [ ] **Python環境**: ユーザーのMac環境でPythonスクリプトを実行するために、いくつかのライブラリ（`python-docx`, `openpyxl`, `python-pptx`）をインストールしていただく必要があります。これを許容いただけるか確認が必要です。

## 提案される変更

### 新規作成: `office_to_notebooklm.py` (仮)
以下の機能を備えた単一のPythonスクリプトを作成します。

#### 1. 共通処理
- 指定フォルダ（サブフォルダ含む）の再帰的走査
- 出力先ディレクトリの自動作成 (`converted_files/`)
- 処理ログの表示

#### 2. Word (.docx) 変換
- ライブラリ: `python-docx`
- ロジック: 段落を読み込み、見出しスタイル（Heading 1, 2...）をMarkdownの `#` に変換。リストや太字もある程度保持しつつテキスト化。

#### 3. Excel (.xlsx) 変換
- ライブラリ: `openpyxl` または `pandas`
- ロジック: 各シートを読み込み、データが存在する範囲をMarkdownの表形式（`| Header | ... |`）に変換。シート名を大見出しとする。

#### 4. PowerPoint (.pptx) 変換
- ライブラリ: `python-pptx`
- ロジック: スライドごとにタイトルと本文テキストボックスを抽出。スライド番号を見出しとしてMarkdown化。

#### 5. 結合機能 (Aggregation)
- 全ファイルの変換終了後、オプションで `All_Files_Combined.txt` のような1つの巨大なテキストファイルに結合する機能。
- NotebookLMはファイル数が50個までという制限があるため、この機能は重要。

## 検証計画
### 自動テスト
- なし（スクリプト単体での動作確認のみ）

### 手動検証
- ダミーのOfficeファイル（Word, Excel, PPT）を用意し、スクリプトを実行。
- 出力されたMarkdownファイルが期待通りにテキスト化されているか確認。
- 結合ファイルが正しく生成されているか確認。
