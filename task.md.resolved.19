# NotebookLM用 Office変換ツール開発タスク

このタスクリストは、NotebookLMへのファイル登録を効率化するための変換ツール開発の進捗を管理します。

## 計画・準備 (Planning)
- [x] **要件定義**: Word/Excel/PPTの変換仕様と視覚情報の扱い(Markdown vs PDF)の決定
- [x] **技術選定**: `python-docx`, `openpyxl`, `python-pptx` (解析用), [markitdown](file:///Users/miitarou/.gemini/antigravity/brain/c9f679ed-ddb6-46b5-961a-7e796abc6428/office_to_notebooklm.py#99-109) (変換用) の採用
- [x] **環境構築**: [requirements.txt](file:///Users/miitarou/.gemini/antigravity/brain/c9f679ed-ddb6-46b5-961a-7e796abc6428/requirements.txt) の作成と環境セットアップ

## 実装フェーズ (Implementation)
- [x] **Word (.docx) 変換機能**の実装 (MarkItDown Engine)
- [x] **Excel (.xlsx) 変換機能**の実装 (CSV埋め込み or MarkItDown Table)
- [x] **PowerPoint (.pptx) 変換機能**の実装 (MarkItDown Engine)
- [x] **結合機能**の実装 (複数ファイルを1つのテキストにまとめる機能)
- [x] **PPTスキップ機能**の実装 (PDF利用推奨のため)
- [x] **視覚要素検知・レポート機能**の実装 (画像・グラフ数をカウントし、テキストとの比率(密度)でPDF利用を推奨するサマリー表示)

- [x] **PDFパススルー機能**: PDFファイルを検知し、ファイル名をフラット化して `converted_files` にコピーする
- [x] **テキストファイル取込機能**: [.txt](file:///Users/miitarou/.gemini/antigravity/brain/c9f679ed-ddb6-46b5-961a-7e796abc6428/requirements.txt), [.md](file:///Users/miitarou/.gemini/antigravity/brain/c9f679ed-ddb6-46b5-961a-7e796abc6428/task.md), [.py](file:///Users/miitarou/.gemini/antigravity/brain/c9f679ed-ddb6-46b5-961a-7e796abc6428/office_to_notebooklm.py) 等を検知し、メタデータヘッダを付与して [.md](file:///Users/miitarou/.gemini/antigravity/brain/c9f679ed-ddb6-46b5-961a-7e796abc6428/task.md) 化する
- [x] **その他バイナリの扱い**: 明示的に除外する拡張子以外は、フラット化コピーで対応（要検討）

## 進化フェーズ (Smart Merge & Universal)
- [x] **Universal Text Loader**: 拡張子不問でテキスト判定し、読み込むロジックの実装
## 進化フェーズ (Smart Merge & Universal)
- [x] **Universal Text Loader**: 拡張子不問でテキスト判定し、読み込むロジックの実装
- [/] **Smart Chunking (Refined)**: ヘッダ込みの厳密な文字数計算と、バイナリSkipログの実装
- [/] **Option Refactor**: `--combine` を廃止し `--merge` を追加（デフォルトはバラ出力のみ、指定時のみマージ生成）


## 検証・仕上げ
- [x] サンプルファイルを用いた変換テスト (Zip/Folder)
- [x] ユーザーへの使用方法ガイド (README) 更新
