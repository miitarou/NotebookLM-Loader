# NotebookLM用 変換ツール アップグレード計画 (with MarkItDown & Zip Support)

## 概要
Microsoft公式の [markitdown](file:///Users/miitarou/.gemini/antigravity/brain/c9f679ed-ddb6-46b5-961a-7e796abc6428/office_to_notebooklm.py#124-135) ライブラリをエンジンとして採用し、変換精度の向上と対応フォーマットの拡充を行います。
さらに、実務で頻出する「ZIPファイル」や「深いフォルダ階層」に対応し、解凍の手間なく一発で処理できる運用性の高さを実現します。

## 変更点

### 1. [requirements.txt](file:///Users/miitarou/.gemini/antigravity/brain/c9f679ed-ddb6-46b5-961a-7e796abc6428/requirements.txt) の更新
- 追加: [markitdown](file:///Users/miitarou/.gemini/antigravity/brain/c9f679ed-ddb6-46b5-961a-7e796abc6428/office_to_notebooklm.py#124-135)

### 2. [office_to_notebooklm.py](file:///Users/miitarou/.gemini/antigravity/brain/c9f679ed-ddb6-46b5-961a-7e796abc6428/office_to_notebooklm.py) の機能強化

#### フォルダ再帰処理 (Folder Recursion)
- 現状の `os.walk` ですでに実装済み。サブフォルダ内のファイルも自動で見つけます。

#### ZIPファイル対応 (Auto-Unzip)
- **課題**: MarkItDown自身もZIPを読めるが、中身の個別ファイルに対する「視覚密度レポート（PDF推奨）」が出せない。
- **対策**: スクリプト側でZIPを一時フォルダ (`_temp_extracted_xxx`) に解凍する処理を追加する。
- **フロー**:
    1. ファイル走査中に `.zip` を発見。
    2. `zipfile` モジュールで解凍。
    3. 解凍したフォルダに対して、再帰的にメインの処理（解析＆変換）を実行。
    4. 処理後に一時フォルダを削除（オプション）。

### 3. ハイブリッド構成（維持）
- **解析フェーズ (Architect)**: 画像数カウント等は自作ロジック。
- **変換フェーズ (Builder)**: テキスト化はMarkItDown。

## 手順
1. ZIP自動解凍ロジックの実装。
2. 既存の [main](file:///Users/miitarou/.gemini/antigravity/brain/c9f679ed-ddb6-46b5-961a-7e796abc6428/office_to_notebooklm.py#136-239) ループから、解凍したフォルダを再帰的に呼べるようにリファクタリング。
3. 動作確認。
